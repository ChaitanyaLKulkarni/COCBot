{"version":3,"sources":["components/PlayerInfo.js","components/MatchInfo.js","App.js","index.js"],"names":["PlayerInfo","playerData","index","sec","Math","floor","duration","slice","className","undefined","language","name","MatchInfo","obj","match","matchData","started","Object","keys","length","noPlayers","tops","players","filter","player","finished","sort","a","b","rank","mode","map","App","chName","useRef","useState","setMatchData","JSON","parse","window","localStorage","getItem","prevData","setPrevData","timer","fetchData","useCallback","tries","current","console","error","fetch","then","res","json","data","status","setTimeout","currData","matchId","p","some","m","winner","r","setItem","stringify","useEffect","location","pathname","split","trim","setInterval","clearInterval","id","style","marginBottom","fontSize","fontWeight","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.79fe1a39.chunk.js","sourcesContent":["import React from \"react\";\n\nfunction PlayerInfo({ playerData, index }) {\n    const sec = Math.floor(playerData.duration / 1000);\n    const duration = `${(\"00\" + Math.floor(sec / 60)).slice(-2)}m:${(\n        \"00\" + Math.floor(sec % 60)\n    ).slice(-2)}s`;\n    return (\n        <div\n            className={\n                \"player-info \" +\n                (index !== undefined\n                    ? index % 2 === 0\n                        ? \"light\"\n                        : \"dark\"\n                    : \"\")\n            }\n        >\n            <div>{playerData.language}</div>\n            <div>{playerData.name}</div>\n            <div>{duration}</div>\n        </div>\n    );\n}\n\nexport default PlayerInfo;\n","import React from \"react\";\nimport PlayerInfo from \"./PlayerInfo\";\n\nconst TOP = 2;\n\nfunction isEmpty(obj) {\n    return Object.keys(obj).length === 0;\n}\n\nfunction MatchInfo({ matchData: match }) {\n    if (!match.started) {\n        return (\n            <div className=\"waiting-container\">\n                <h2>\n                    {!isEmpty(match)\n                        ? \"Waiting for Players\"\n                        : \"No Match Found!!!\"}\n                </h2>\n                <p>\n                    Players:<span className=\"no-player\">{match.noPlayers}</span>\n                </p>\n            </div>\n        );\n    }\n    const tops = match.players\n        .filter((player) => player.finished)\n        .sort((a, b) => a.rank - b.rank)\n        .slice(0, TOP);\n    return (\n        <div className=\"match-info\">\n            <h2>Mode:{match.mode}</h2>\n            {tops.length === 0 && <h2>Clashining..</h2>}\n            {tops.map((player, index) => (\n                <PlayerInfo\n                    key={player.name}\n                    playerData={player}\n                    index={index}\n                />\n            ))}\n            <p>\n                Players:\n                <span className=\"no-player\">{match.noPlayers}</span>\n            </p>\n        </div>\n    );\n}\n\nexport default MatchInfo;\n","import React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport MatchInfo from \"./components/MatchInfo\";\nimport PlayerInfo from \"./components/PlayerInfo\";\nimport \"./App.css\";\n\nfunction App() {\n    const chName = useRef(\"\"); //Holds Channle Name\n    const [matchData, setMatchData] = useState({}); //Holds Current Match Data\n\n    //Hold PrevData Initilized by getting `prevData` from localStorage\n    const [prevData, setPrevData] = useState(\n        JSON.parse(window.localStorage.getItem(\"prevData\")) || []\n    );\n    //Timer for setIntervals\n    const timer = useRef(null);\n\n    const fetchData = useCallback((tries = 0) => {\n        //If Channle Name is Not there return\n        if (chName.current === \"\") return;\n\n        if (tries >= 3) {\n            console.error(\"Failed to get valid Data After 3 tries!\");\n            return;\n        }\n\n        //get Report related to Channle Name\n        fetch(`/api/${chName.current}`)\n            .then((res) => res.json())\n            .then((data) => {\n                // if conflict was found\n                if (data.status === 409)\n                    setTimeout(() => fetchData(tries + 1), 200);\n\n                //If got error in report return\n                if (data.status !== 200) return;\n\n                //Set matchData to currentely feteched data\n                setMatchData((currData) => {\n                    //Check if Different match\n                    // i.e. new lobby\n                    if (currData.matchId !== data.matchId) {\n                        //If current lobby was started then put it in PrevData and Save to localStorae\n                        if (currData && currData.started) {\n                            setPrevData((p) => {\n                                if (\n                                    p.some(\n                                        (m) => m.matchId === currData.matchId\n                                    )\n                                )\n                                    return p;\n                                const winner = currData.players\n                                    .filter((player) => player.finished)\n                                    .sort((a, b) => a.rank - b.rank)[0];\n                                const r = [\n                                    {\n                                        matchId: currData.matchId,\n                                        mode: currData.mode,\n                                        winner: winner,\n                                    },\n                                    ...p,\n                                ];\n                                window.localStorage.setItem(\n                                    \"prevData\",\n                                    JSON.stringify(r)\n                                );\n                                return r;\n                            });\n                        }\n                    }\n                    return data;\n                });\n            });\n    }, []);\n\n    useEffect(() => {\n        fetch(\"/start\");\n        chName.current = window.location.pathname\n            .split(\"/\")\n            .slice(-1)[0]\n            .trim();\n        fetchData();\n        timer.current = setInterval(() => fetchData(), 5000);\n\n        //Cleanup code for timer\n        return () => {\n            clearInterval(timer.current);\n            timer.current = null;\n        };\n    }, [fetchData]);\n\n    return (\n        <div className=\"App\">\n            {\n                //<h1>{chName.current || \"GOTO : /web/<ChannleName>\"}</h1>\n            }\n            <div id=\"main\">\n                <MatchInfo matchData={matchData} />\n                <div style={{ marginBottom: 5 }}>\n                    {\n                        //Previous</br>\n                    }\n                    <span style={{ fontSize: \"20px\", fontWeight: \"bolder\" }}>\n                        Winners\n                    </span>\n                    :\n                </div>\n                <div id=\"prev-container\">\n                    {prevData.map((data) => (\n                        <PlayerInfo\n                            key={data.matchId}\n                            playerData={data.winner}\n                            matchData={data}\n                        />\n                    ))}\n                </div>\n            </div>\n            )\n        </div>\n    );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}